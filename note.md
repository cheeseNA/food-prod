# id, label, name について

foodid_dict と IngredientList588.txt は行番号・名前が対応している. 齟齬があるのは"水"または"N/A"の 1 行のみ.
よって ingres や name2idx といったコード中の変数は安全に破棄できる.

ingre_id_label_expression_table.csv は 0-indexed である. 以下のズレがある.

<details>
<summary>ズレ</summary>

```
>>> for i in range(len(lines)):
...     if i not in table_map or (lines[i] != foodid[str(i+1)][2] or lines[i] != table_map[i]):
...             print(i, lines[i], foodid[str(i+1)], table_map[i+1] if i+1 in table_map else None)
...
2 N/A ['#N/A', '#N/A', '水', ['水', '', 'バニラエッセンス', 'お湯', 'ローリエ', 'トッピング', 'ぬるま湯', '熱湯', 'お水', 'バニラオイル', 'A', '氷', '生地', '具', 'Ａ', 'お好みで', '湯', '具材', 'フィリング', '冷水', '材料', '仕上げ', 'ベビーリーフ', '下味', 'その他', '味付け', 'A水', '仕上げ用', 'パスタの茹で汁', 'ミントの葉', '野菜', 'お好みの野菜', 'B', '飾り', '食紅', 'バニラビーンズ', 'クッキー生地', 'ローリエの葉', 'コチジャン', '飾り用', 'ポテトサラダ', 'お好きな野菜', 'Ｂ', '付け合わせ', 'ローレル', 'ミント', 'サフラン', 'ドライフルーツ', 'アルミホイル', 'お好みの具', 'デコレーション', 'Ａ水', '爪楊枝', 'ドライクランベリー', 'トッピング用', '茹で汁', ' コアントロー', 'ベイリーフ', 'カルダモン', 'ディル', 'ケッパー', 'ラップ', 'クッキングシート', 'フルーツ', '炭酸水', 'たれの材料', '八角', 'パスタのゆで汁', '付け合せ', '好きな野菜', 'ソースの材料', '漬け汁', 'あんかけ', ' サントリー天然水', '土台', '〇水', 'ビニール袋', 'お好きな具', '調味料A', '下味用', 'B水', 'ゆで汁', 'キッチンペーパー', 'つまようじ', 'お好みのフルーツ', 'お好みの具材', 'ターメリックパウダー', 'バニラエッセンスあれば', ' 中身', 'ケイパー', '月桂樹の葉', '食紅赤', '水ゼラチン用', 'ﾊﾞﾆﾗｴｯｾﾝｽ', 'ローリエあれば', '氷水', 'ボトム', '好みの野菜', '杏仁霜', '材料名', 'アーモンドエッセンス', '調味液', 'かぼちゃの種', 'クエン酸', '化学調味料', 'オレガノ乾燥', '桜の塩漬け', '竹串', '好みで', '桜の花の塩漬け']] 醤油
139 わさび ['17081', '＜香辛料類＞ わさび 練り', 'わさび', ['わさび', 'わさびチューブ', '練りわさび']] 粉砂糖
215 わかめ ['9039', 'わかめ 原藻 生', 'わかめ', ['わかめ', 'ワカメ', '生わかめ']] ひじき
226 パルスイート ['3031', '（でん粉糖類） 還元麦芽糖', 'パルスイート', ['パルスイート']] 焼肉のタレ
233 サニーレタス ['6315', '（レタス類） サニーレタス 葉 生', 'サニーレタス', ['サニーレタス']] ブイヨン
241 マシュマロ ['15113', '＜キャンデー類＞ マシュマロ', 'マシュマロ', ['マシュマロ']] 青梗菜
249 トマトジュース ['6185', '（トマト類） 加工品 トマトジュース 食塩添加', 'トマトジュース', ['トマトジュース']] 手羽先
256 ホイップクリーム ['13017', '＜牛乳及び乳製品＞ （クリーム類） ホイップクリーム 乳脂肪', 'ホイップクリーム', ['ホイップクリーム']] フランスパン
259 ビスケット ['15097', '＜ビスケット類＞ ビスケット ハードビスケット', 'ビスケット', ['ビスケット', 'グラハムクラッカー', 'マリービスケット']] ししとう
265 粗塩 ['17013', '＜調味料類＞ （食塩類） 並塩', '粗塩', ['粗塩', 'あら塩']] 冷凍コーン
272 シロップ ['3027', '（でん粉糖類） 異性化液糖 果糖ぶどう糖液糖', 'シロップ', ['シロップ', 'ガムシロップ']] カリフラワー
279 豆苗 ['6019', '（えんどう類） トウミョウ 茎葉 生', '豆苗', ['豆苗']] 紅しょうが
281 黒豆 ['4106', 'だいず ［全粒・全粒製品］ 全粒 黒大豆 国産 ゆで', '黒豆', ['黒豆']] カレー
283 グレープフルーツ ['7062', '（かんきつ類） グレープフルーツ 白肉種 砂じょう 生', 'グレープフルーツ', ['グレープフルーツ']] トマトピューレ
286 モロヘイヤ ['6293', 'モロヘイヤ 茎葉 生', 'モロヘイヤ', ['モロヘイヤ']] None
287 ブルーベリー ['7124', 'ブルーベリー 生', 'ブルーベリー', ['ブルーベリー', '冷凍ブルーベリー']] タイム
296 ホワイトチョコ ['15115', '＜チョコレート類＞ ホワイトチョコレート', 'ホワイトチョコ', ['ホワイトチョコ', 'ホワイトチョコレート']] ミートソース
316 あさつき ['6003', 'あさつき 葉 生', 'あさつき', ['あさつき']] None
317 松の実 ['5032', 'まつ 生', '松の実', ['松の実']] きくらげ
323 わけぎ ['6320', 'わけぎ 葉 生', 'わけぎ', ['わけぎ']] 小豆
325 マーマレード ['7046', '（かんきつ類） オレンジ バレンシア マーマレード 高糖度', 'マーマレード', ['マーマレード', 'オレンジマーマレード']] None
326 オレンジジュース ['7044', '（かんきつ類） オレンジ バレンシア 果実飲料 50%果汁入り飲料', 'オレンジジュース', ['オレンジジュース']] 中力粉
333 サラダ菜 ['6313', '（レタス類） サラダな 葉 生', 'サラダ菜', ['サラダ菜']] ホタテ
335 昆布だし ['17132', '＜調味料類＞ （だし類） 昆布だし 煮出し', '昆布だし', ['昆布だし']] 青じそドレッシング
341 かつおだし ['17019', '＜調味料類＞ （だし類） かつおだし 荒節', 'かつおだし', ['かつおだし', '鰹だし']] マグロ
345 パプリカパウダー ['17079', '＜香辛料類＞ パプリカ 粉', 'パプリカパウダー', ['パプリカパウダー']] チェダーチーズ
347 トマトペースト ['17035', '＜調味料類＞ （トマト加工品類） トマトペースト', 'トマトペースト', ['トマトペースト']] None
348 クレソン ['6077', 'クレソン 茎葉 生', 'クレソン', ['クレソン']] 柚子
353 桃 ['7136', '（もも類） もも 白肉種 生', '桃', ['桃']] コーンフレーク
356 そら豆 ['6124', 'そらまめ 未熟豆 生', 'そら豆', ['そら豆']] None
357 ササミ ['11217', '＜鳥肉類＞ にわとり ［親・副品目］ ささみ 生', 'ササミ', ['ササミ', '鶏ささ身']] None
358 大根の皮 ['6132', '（だいこん類） だいこん 根 皮つき 生', '大根の皮', ['大根の皮']] None
359 カシューナッツ ['5005', 'カシューナッツ フライ 味付け', 'カシューナッツ', ['カシューナッツ']] 玄米
362 あん ['4101', 'あずき あん こし練りあん （並あん）', 'あん', ['あん']] 山椒
364 スポンジ ['15074', '＜ケーキ・ペストリー類＞ スポンジケーキ', 'スポンジ', ['スポンジ', 'スポンジケーキ', 'スポンジ生地']] りんご酢
366 ライスペーパー ['1169', 'こめ ［うるち米製品］ ライスペーパー', 'ライスペーパー', ['ライスペーパー', '生春巻きの皮']] None
367 オレンジピール ['7041', '（かんきつ類） オレンジ バレンシア 米国産 砂じょう 生', 'オレンジピール', ['オレンジピール']] 塩鮭
370 大豆 ['4023', 'だいず ［全粒・全粒製品］ 全粒 黄大豆 国産 乾', '大豆', ['大豆']] None
371 いくら ['10140', '＜魚類＞ （さけ・ます類） しろさけ イクラ', 'いくら', ['いくら', 'イクラ']] 野菜ジュース
377 ジャム ['7014', 'いちご ジャム 低糖度', 'ジャム', ['ジャム', 'イチゴジャム', 'いちごジャム', '苺ジャム']] None
378 たくあん ['6139', '（だいこん類） 漬物 たくあん漬 干しだいこん漬', 'たくあん', ['たくあん']] None
379 新生姜 ['6386', '（しょうが類） 新しょうが 根茎 生', '新生姜', ['新生姜']] クラッカー
383 パイナップル ['7097', 'パインアップル 生', 'パイナップル', ['パイナップル']] そば
386 梨 ['7088', '（なし類） 日本なし 生', '梨', ['梨']] None
387 紅茶 ['16044', '＜茶類＞ （発酵茶類） 紅茶 浸出液', '紅茶', ['紅茶']] None
388 グレープシードオイル ['14028', '（植物油脂類） ぶどう油', 'グレープシードオイル', ['グレープシードオイル']] None
389 ピーナッツ ['5034', 'らっかせい 大粒種 乾', 'ピーナッツ', ['ピーナッツ']] ライ麦粉
392 シュウマイの皮 ['1075', 'こむぎ ［その他］ しゅうまいの皮 生', 'シュウマイの皮', ['シュウマイの皮']] コンビーフ
396 コーヒーフレッシュ ['13021', '＜牛乳及び乳製品＞ （クリーム類） コーヒーホワイトナー 液状 乳脂肪・植物性脂肪', 'コーヒーフレッシュ', ['コーヒーフレッシュ']] None
397 お好み焼き粉 ['1146', 'こむぎ ［小麦粉］ プレミックス粉 お好み焼き用', 'お好み焼き粉', ['お好み焼き粉']] None
398 フレンチドレッシング ['17149', '＜調味料類＞ （ドレッシング類） 乳化液状ドレッシング フレンチドレッシング 乳化液状', 'フレンチドレッシング', ['フレンチドレッシング', 'シーザードレッシング']] 鯖
400 みかん ['7029', '（かんきつ類） うんしゅうみかん 砂じょう 普通 生', 'みかん', ['みかん']] ぶり
403 ワサビ ['6322', 'わさび 根茎 生', 'ワサビ', ['ワサビ']] None
404 マリネ液 ['17111', '＜調味料類＞ （調味ソース類） マリネ液', 'マリネ液', ['マリネ液']] None
405 ホワイトペッパー ['17064', '＜香辛料類＞ こしょう 白 粉', 'ホワイトペッパー', ['ホワイトペッパー', '白胡椒', '白コショウ', '白こしょう']] 豆もやし
407 梅酒 ['16022', '＜アルコール飲料類＞ （混成酒類） 梅酒', '梅酒', ['梅酒']] いわし
412 ドライトマト ['6370', '（トマト類） ドライトマト', 'ドライトマト', ['ドライトマト']] None
413 甘納豆 ['15001', '＜和生菓子・和半生菓子類＞ 甘納豆 あずき', '甘納豆', ['甘納豆']] None
414 白身魚 ['10199', '＜魚類＞ （たら類） すけとうだら 生', '白身魚', ['白身魚']] ピーナッツバター
416 パン粉衣用 ['1079', 'こむぎ ［その他］ パン粉 乾燥', 'パン粉衣用', ['パン粉衣用']] None
417 牛すじ ['11101', '＜畜肉類＞ うし ［副生物］ 腱 ゆで', '牛すじ', ['牛すじ', '牛すじ肉']] 無塩マーガリン
422 麩 ['1066', 'こむぎ ［ふ類］ 焼きふ 釜焼きふ', '麩', ['麩', 'お麩']] めかぶ
426 ブラックオリーブ ['7038', 'オリーブ 塩漬 ブラックオリーブ', 'ブラックオリーブ', ['ブラックオリーブ', '黒オリーブ']] None
427 卵焼き ['12018', '鶏卵 たまご焼 厚焼きたまご', '卵焼き', ['卵焼き', '錦糸卵']] かぶの葉
429 カニ缶 ['10340', '＜えび・かに類＞ （かに類） たらばがに 水煮缶詰', 'カニ缶', ['カニ缶']] None
430 白すりゴマ ['5019', 'ごま むき', '白すりゴマ', ['白すりゴマ', '黒すりごま']] 粒あん
432 甘酢 ['17094', '＜調味料類＞ （調味ソース類） 甘酢', '甘酢', ['甘酢', '甘酢あん']] 紫玉ねぎ
435 おにぎり ['1111', 'こめ ［うるち米製品］ おにぎり', 'おにぎり', ['おにぎり']] 焼き豆腐
437 春雨乾燥 ['2040', '＜でん粉・でん粉製品＞ （でん粉製品） はるさめ 普通はるさめ 乾', '春雨乾燥', ['春雨乾燥']] ラディッシュ
439 クッキー ['15054', '＜ビスケット類＞ 中華風クッキー', 'クッキー', ['クッキー']] None
440 マスカルポーネ ['13055', '＜牛乳及び乳製品＞ （チーズ類） ナチュラルチーズ マスカルポーネ', 'マスカルポーネ', ['マスカルポーネ', 'マスカルポーネチーズ']] ラード
443 ビール ['16006', '＜アルコール飲料類＞ （醸造酒類） ビール 淡色', 'ビール', ['ビール']] 豚ヒレ肉
445 桜でんぶ ['10448', '＜魚類＞ （たら類） 加工品 桜でんぶ', '桜でんぶ', ['桜でんぶ']] トースト
448 なめ茸 ['8003', 'えのきたけ 味付け瓶詰', 'なめ茸', ['なめ茸']] None
449 低脂肪乳 ['13005', '＜牛乳及び乳製品＞ （液状乳類） 加工乳 低脂肪', '低脂肪乳', ['低脂肪乳', '低脂肪牛乳']] そば粉
452 梅酢 ['7020', 'うめ 梅漬 塩漬', '梅酢', ['梅酢']] None
453 パンの耳 ['1176', 'こむぎ ［パン類］ 角形食パン 耳', 'パンの耳', ['パンの耳']] ツナ缶ノンオイル
456 マーマレードジャム ['7047', '（かんきつ類） オレンジ バレンシア マーマレード 低糖度', 'マーマレードジャム', ['マーマレードジャム']] ふき
460 いちじく ['7015', 'いちじく 生', 'いちじく', ['いちじく']] None
461 マッシュポテト ['2021', '＜いも類＞ じゃがいも 乾燥マッシュポテト', 'マッシュポテト', ['マッシュポテト']] None
462 生クリーム植物性 ['13016', '＜牛乳及び乳製品＞ （クリーム類） クリーム 植物性脂肪', '生クリーム植物性', ['生クリーム植物性']] カルピス
464 ホワイトリカー ['16014', '＜アルコール飲料類＞ （蒸留酒類） しょうちゅう 連続式蒸留しょうちゅう', 'ホワイトリカー', ['ホワイトリカー', '焼酎']] None
465 チャーシュー ['11195', '＜畜肉類＞ ぶた ［その他］ 焼き豚', 'チャーシュー', ['チャーシュー', '焼き豚', '焼豚']] None
466 スライスチーズとろけないタイプ ['13036', '＜牛乳及び乳製品＞ （チーズ類） ナチュラルチーズ ゴーダ', 'スライスチーズとろけないタイプ', ['スライスチーズとろけないタイプ']] None
467 ジンジャーパウダー ['17068', '＜香辛料類＞ しょうが 粉', 'ジンジャーパウダー', ['ジンジャーパウダー']] ロールパン
469 切り昆布 ['9020', '（こんぶ類） 刻み昆布', '切り昆布', ['切り昆布']] None
470 味覇 ['10389', '＜魚類＞ （あじ類） まあじ 皮なし 生', '味覇', ['味覇']] ひきわり納豆
472 皮 ['11234', '＜鳥肉類＞ にわとり ［副品目］ 皮 むね 生', '皮', ['皮']] None
473 高菜 ['6147', 'たかな 葉 生', '高菜', ['高菜']] None
474 合わせ酢 ['17099', '＜調味料類＞ （調味ソース類） 三杯酢', '合わせ酢', ['合わせ酢']] ヤングコーン
480 ししゃも ['10180', '＜魚類＞ （ししゃも類） ししゃも 生干し 生', 'ししゃも', ['ししゃも']] 鱈
482 アプリコットジャム ['7010', 'あんず ジャム 高糖度', 'アプリコットジャム', ['アプリコットジャム']] None
483 しょうゆみりん ['17088', '＜調味料類＞ （しょうゆ類） 照りしょうゆ', 'しょうゆみりん', ['しょうゆみりん', 'すき焼きのたれ', 'すき焼きのタレ']] 豚肩ロース
485 ふりかけ ['17127', '＜調味料類＞ （その他） ふりかけ たまご', 'ふりかけ', ['ふりかけ']] None
486 ミルクココア ['16049', '＜コーヒー・ココア類＞ ココア ミルクココア', 'ミルクココア', ['ミルクココア', '調整ココア', 'バンホーテンピュアココア']] ひじきの煮物
490 りんごジュース ['7152', 'りんご 果実飲料 30%果汁入り飲料', 'りんごジュース', ['りんごジュース']] もずく
492 オレオ ['15092', '＜ビスケット類＞ ウエハース', 'オレオ', ['オレオ']] None
493 クコの実 ['7185', 'くこ 実 乾', 'クコの実', ['クコの実']] None
494 マンゴー ['7132', 'マンゴー 生', 'マンゴー', ['マンゴー']] None
495 ブラックタイガー ['10329', '＜えび・かに類＞ （えび類） ブラックタイガー 養殖 生', 'ブラックタイガー', ['ブラックタイガー']] None
496 ガーリックソルト ['17128', '＜香辛料類＞ にんにく ガーリックパウダー 食塩添加', 'ガーリックソルト', ['ガーリックソルト']] ブルーチーズ
499 減塩醤油 ['17086', '＜調味料類＞ （しょうゆ類） こいくちしょうゆ 減塩', '減塩醤油', ['減塩醤油']] None
500 らっきょう ['6305', '（らっきょう類） らっきょう りん茎 生', 'らっきょう', ['らっきょう']] None
501 かんぴょう ['6056', 'かんぴょう 乾', 'かんぴょう', ['かんぴょう']] 牛脂
505 スイカ ['7077', 'すいか 赤肉種 生', 'スイカ', ['スイカ']] サラミ
507 クランベリー ['7146', 'ラズベリー 生', 'クランベリー', ['クランベリー']] None
508 芽キャベツ ['6283', 'めキャベツ 結球葉 生', '芽キャベツ', ['芽キャベツ']] 八丁味噌
510 目玉焼き ['12021', '鶏卵 全卵 目玉焼き', '目玉焼き', ['目玉焼き']] None
511 牛肉こま切れ ['11067', '＜畜肉類＞ うし ［輸入牛肉］ リブロース 脂身つき 生', '牛肉こま切れ', ['牛肉こま切れ']] None
512 残ったカレー ['18040', '洋風料理 カレー類 チキンカレー', '残ったカレー', ['残ったカレー', 'レトルトカレー']] None
513 キャラメル ['15105', '＜キャンデー類＞ キャラメル', 'キャラメル', ['キャラメル']] お茶漬けの素
515 カステラ ['15009', '＜和生菓子・和半生菓子類＞ カステラ', 'カステラ', ['カステラ']] None
516 ひよこ豆 ['4065', 'ひよこまめ 全粒 乾', 'ひよこ豆', ['ひよこ豆']] None
517 お好みのジャム ['7013', 'いちご ジャム 高糖度', 'お好みのジャム', ['お好みのジャム']] None
518 ごまだれ ['17098', '＜調味料類＞ （調味ソース類） ごまだれ', 'ごまだれ', ['ごまだれ']] コーラ
522 ナッツ ['5031', 'マカダミアナッツ いり 味付け', 'ナッツ', ['ナッツ', 'ナッツ類']] None
523 ブロッコリースプラウト ['6354', 'ブロッコリー 芽ばえ 生', 'ブロッコリースプラウト', ['ブロッコリースプラウト']] None
524 マロンクリーム ['15117', '＜果実菓子類＞ マロングラッセ', 'マロンクリーム', ['マロンクリーム']] None
525 タピオカ粉 ['2028', '＜でん粉・でん粉製品＞ （でん粉類） キャッサバでん粉', 'タピオカ粉', ['タピオカ粉']] None
526 カルピス原液 ['13028', '＜牛乳及び乳製品＞ （発酵乳・乳酸菌飲料） 乳酸菌飲料 乳製品', 'カルピス原液', ['カルピス原液']] None
527 冷凍いんげん ['4008', 'いんげんまめ 全粒 ゆで', '冷凍いんげん', ['冷凍いんげん']] None
528 ホエー ['13048', '＜牛乳及び乳製品＞ （その他） カゼイン', 'ホエー', ['ホエー']] None
529 さきいか ['10354', '＜いか・たこ類＞ （いか類） 加工品 さきいか', 'さきいか', ['さきいか']] インゲン豆
534 Aマヨネーズ ['17043', '＜調味料類＞ （ドレッシング類） 半固形状ドレッシング マヨネーズ 卵黄型', 'Aマヨネーズ', ['Aマヨネーズ', 'マヨ']] None
535 コーンクリーム缶 ['6179', '（とうもろこし類） スイートコーン 缶詰 クリームスタイル', 'コーンクリーム缶', ['コーンクリーム缶']] None
536 空豆 ['4019', 'そらまめ 全粒 乾', '空豆', ['空豆']] None
537 冷凍かぼちゃ ['6050', '（かぼちゃ類） 西洋かぼちゃ 果実 冷凍', '冷凍かぼちゃ', ['冷凍かぼちゃ']] None
538 うど ['6012', '（うど類） うど 茎 生', 'うど', ['うど']] None
539 甘酒 ['16050', '＜その他＞ 甘酒', '甘酒', ['甘酒']] None
540 おかひじき ['6030', 'おかひじき 茎葉 生', 'おかひじき', ['おかひじき']] ホタテ缶
542 銀杏 ['5008', 'ぎんなん 生', '銀杏', ['銀杏']] 生ひじき
545 トマトジュース無塩 ['6340', '（トマト類） 加工品 トマトジュース 食塩無添加', 'トマトジュース無塩', ['トマトジュース無塩']] None
546 ふきのとう ['6258', '（ふき類） ふきのとう 花序 生', 'ふきのとう', ['ふきのとう']] がんもどき
551 ビーフン ['1115', 'こめ ［うるち米製品］ ビーフン', 'ビーフン', ['ビーフン']] パイナップル缶詰
553 押し麦 ['1006', 'おおむぎ 押麦 乾', '押し麦', ['押し麦']] チョコクリーム
555 サンドイッチ用パン ['1175', 'こむぎ ［パン類］ 角形食パン 耳を除いたもの', 'サンドイッチ用パン', ['サンドイッチ用パン']] 煮干し
557 セージ ['17070', '＜香辛料類＞ セージ 粉', 'セージ', ['セージ']] メンマ
559 薩摩芋 ['2045', '＜いも類＞ （さつまいも類） さつまいも 塊根 皮つき 生', '薩摩芋', ['薩摩芋']] ドライマンゴー
561 ミックスナッツ ['5002', 'アーモンド フライ 味付け', 'ミックスナッツ', ['ミックスナッツ']] 冷凍ポテト
563 車麩 ['1068', 'こむぎ ［ふ類］ 焼きふ 車ふ', '車麩', ['車麩']] かつお
565 グラハム粉 ['1023', 'こむぎ ［小麦粉］ 強力粉 全粒粉', 'グラハム粉', ['グラハム粉']] None
566 唐揚げ粉 ['1147', 'こむぎ ［小麦粉］ プレミックス粉 から揚げ用', '唐揚げ粉', ['唐揚げ粉']] None
567 ココナッツ ['7157', 'ココナッツ ココナッツウォーター', 'ココナッツ', ['ココナッツ']] None
568 大和芋 ['2025', '＜いも類＞ （やまのいも類） ながいも やまといも 塊根 生', '大和芋', ['大和芋']] None
569 葛粉 ['2029', '＜でん粉・でん粉製品＞ （でん粉類） くずでん粉', '葛粉', ['葛粉']] None
570 せり ['6117', 'せり 茎葉 生', 'せり', ['せり']] None
571 みかんの缶詰 ['7035', '（かんきつ類） うんしゅうみかん 缶詰 果肉', 'みかんの缶詰', ['みかんの缶詰']] 冷凍ほうれん草
573 わさび菜 ['6323', 'わさび わさび漬', 'わさび菜', ['わさび菜']] None
574 きんぴらごぼう ['18033', '和風料理 煮物類 きんぴらごぼう', 'きんぴらごぼう', ['きんぴらごぼう']] None
575 メロン ['7134', 'メロン 温室メロン 生', 'メロン', ['メロン']] None
576 鶏手羽 ['11218', '＜鳥肉類＞ にわとり ［若どり・主品目］ 手羽 皮つき 生', '鶏手羽', ['鶏手羽']] ヤーコン
578 ココナッツオイル ['14013', '（植物油脂類） やし油', 'ココナッツオイル', ['ココナッツオイル']] コロッケ
580 塩蔵わかめ ['9045', 'わかめ 湯通し塩蔵わかめ 塩抜き 生', '塩蔵わかめ', ['塩蔵わかめ']] None
581 ベーグル ['1148', 'こむぎ ［パン類］ ベーグル', 'ベーグル', ['ベーグル']] None
582 豚レバー ['11166', '＜畜肉類＞ ぶた ［副生物］ 肝臓 生', '豚レバー', ['豚レバー']] カジキマグロ
585 うなぎ ['10067', '＜魚類＞ うなぎ 養殖 生', 'うなぎ', ['うなぎ']] None
586 かぼちゃの煮物 ['6049', '（かぼちゃ類） 西洋かぼちゃ 果実 ゆで', 'かぼちゃの煮物', ['かぼちゃの煮物']] None
587 リコッタチーズ ['13058', '＜牛乳及び乳製品＞ （チーズ類） ナチュラルチーズ リコッタ', 'リコッタチーズ', ['リコッタチーズ']] None
```

</details>

ingredient id で調査してみたが, そちらも駄目.

<details>
<summary>ingredient id で調査</summary>

```
>>> for key, value in foodid.items():
...     if value[0] != "#N/A" and (int(value[0]) not in table_map_2 or value[2] != table_map_2[int(value[0])]):
...             print(value[0], value[2], table_map_2.get(int(value[0]), None))
...
17046 味噌 None
17081 わさび None
9039 わかめ None
3031 パルスイート None
17045 白味噌 味噌
6315 サニーレタス None
15113 マシュマロ None
6185 トマトジュース None
13017 ホイップクリーム None
15097 ビスケット None
17013 粗塩 None
3027 シロップ None
6019 豆苗 None
4106 黒豆 None
7062 グレープフルーツ None
6293 モロヘイヤ None
7124 ブルーベリー None
15115 ホワイトチョコ None
6003 あさつき None
5032 松の実 None
6320 わけぎ None
7046 マーマレード None
7044 オレンジジュース None
6313 サラダ菜 None
17132 昆布だし None
17019 かつおだし None
17079 パプリカパウダー None
17035 トマトペースト None
6077 クレソン None
7136 桃 None
6124 そら豆 None
11217 ササミ None
6132 大根の皮 None
5005 カシューナッツ None
4101 あん None
15074 スポンジ None
1169 ライスペーパー None
7041 オレンジピール None
4023 大豆 None
10140 いくら None
7014 ジャム None
6139 たくあん None
6386 新生姜 None
7097 パイナップル None
7088 梨 None
16044 紅茶 None
14028 グレープシードオイル None
5034 ピーナッツ None
1075 シュウマイの皮 None
13021 コーヒーフレッシュ None
1146 お好み焼き粉 None
17149 フレンチドレッシング None
7029 みかん None
6322 ワサビ None
17111 マリネ液 None
17064 ホワイトペッパー None
16022 梅酒 None
6370 ドライトマト None
15001 甘納豆 None
10199 白身魚 None
1079 パン粉衣用 None
11101 牛すじ None
1066 麩 None
7038 ブラックオリーブ None
12018 卵焼き None
10340 カニ缶 None
5019 白すりゴマ None
17094 甘酢 None
1111 おにぎり None
2040 春雨乾燥 None
15054 クッキー None
13055 マスカルポーネ None
16006 ビール None
10448 桜でんぶ None
8003 なめ茸 None
13005 低脂肪乳 None
7020 梅酢 None
1176 パンの耳 None
7047 マーマレードジャム None
7015 いちじく None
2021 マッシュポテト None
13016 生クリーム植物性 None
16014 ホワイトリカー None
11195 チャーシュー None
13036 スライスチーズとろけないタイプ None
17068 ジンジャーパウダー None
9020 切り昆布 None
10389 味覇 None
11234 皮 None
6147 高菜 None
17099 合わせ酢 None
10180 ししゃも None
7010 アプリコットジャム None
17088 しょうゆみりん None
17127 ふりかけ None
16049 ミルクココア None
7152 りんごジュース None
15092 オレオ None
7185 クコの実 None
7132 マンゴー None
10329 ブラックタイガー None
17128 ガーリックソルト None
17086 減塩醤油 None
6305 らっきょう None
6056 かんぴょう None
7077 スイカ None
7146 クランベリー None
6283 芽キャベツ None
12021 目玉焼き None
11067 牛肉こま切れ None
18040 残ったカレー None
15105 キャラメル None
15009 カステラ None
4065 ひよこ豆 None
7013 お好みのジャム None
17098 ごまだれ None
5031 ナッツ None
6354 ブロッコリースプラウト None
15117 マロンクリーム None
2028 タピオカ粉 None
13028 カルピス原液 None
4008 冷凍いんげん None
13048 ホエー None
10354 さきいか None
17043 Aマヨネーズ None
6179 コーンクリーム缶 None
4019 空豆 None
6050 冷凍かぼちゃ None
6012 うど None
16050 甘酒 None
6030 おかひじき None
5008 銀杏 None
6340 トマトジュース無塩 None
6258 ふきのとう None
1115 ビーフン None
1006 押し麦 None
1175 サンドイッチ用パン None
17070 セージ None
2045 薩摩芋 None
5002 ミックスナッツ None
1068 車麩 None
1023 グラハム粉 None
1147 唐揚げ粉 None
7157 ココナッツ None
2025 大和芋 None
2029 葛粉 None
6117 せり None
7035 みかんの缶詰 None
6323 わさび菜 None
18033 きんぴらごぼう None
7134 メロン None
11218 鶏手羽 None
14013 ココナッツオイル None
9045 塩蔵わかめ None
1148 ベーグル None
11166 豚レバー None
10067 うなぎ None
6049 かぼちゃの煮物 None
13058 リコッタチーズ None
```

</details>

# method について

- method1 は古いものっぽく, normalized cooccurence を使用していない模様.
- よって無印, method2 を使用する.

# 画像の再アップロードを可能にするには (全体のリファクタ)

- 現在のプログラムは, 初期化処理の実行とかが複数回実行されないようになっている
- `uploaded_image`のイベントが発行したときに, stage を巻き戻して初期化を再実行する必要がある
  - 初期化処理を関数として切り出したい
  - 初期化処理と描画処理を分けたい
- グラフを表示したあとチェックボックスを入力するとエラーになるのもやめたい

案

- stage のような変数を用いて, stage が変わるようなことが起こったときに stage のインクリメントと初期化を行う
- できるだけ session_state に保存する初期化を減らす
  - session_state と cached 関数の使い分けはどうするか？
- てかそもそも stage いらなくないか？最初から全部表示しちゃえば

- session_state として持つべきもの

  - uploaded_image
  - selected_ingres
  - table

- 画像がアップロードされたら, stage を初期化して変数の初期化を行う
  - stage のみがステージ情報を持つようにする. さもないと画像アップロード時に各フラグを倒す必要が出てくる
  - stage がある一定になると都度初期化し stage を上げる, のようにする
  - 入力とか画像変更とかに応じて変わるものは初期化 stage で扱わない. 前処理とか変数の宣言のために初期化する.
  - というか, session_state に保存するようなやつは初期化が必要. それ以外の実行のたびに変わるやつは初期化 stage 使わない.

# session_state の ingre 関連の変数についての整理

- まず, checkbox が再実行を超えて stateful なことに注意.
- mask: [1] \* 588 np.array
  - 再描画のたびに`update_mask(selected_ingres, mask)`で更新される.
    - `normalized_matrix`を用いて, 共起の可能性が一定度以上低い食材を倒している.
  - 「新しい食材を生成」ボタンの際に, `predict_ingres`の食材が全部倒される.
- predict_ingres: 0-indexed food label
  - `[152, 54, 3, 411, 45, 46, 28, 1, 5, 7]`
  - `get_current_candidate`により`mask`と画像を用いて生成. 長さ 10. 「新しい食材を生成」ボタンの際に, このリストを用いてマスクが更新され, 更新されたマスクをもとに`get_current_candidate`が再び呼ばれる.
- selected_options: dict
  - `{152: False, 54: False, 3: True, 411: False, 45: True, 46: False, 28: False, 1: False, 5: False, 7: False}`
  - 初期化は画像アップロード時 (`{}`)
  - 描画ごとに`predict_ingres`を用いて追加される. (`selected_options[item] = c2.checkbox(label_to_name[xxx])`)
- selected_ingres

  - `[3, 45]`
  - これをもとに一番右の選択された食材 checklist が作成される.
  - 描画のたびに初期化. `selected_options`が True の label.
  - multiselect が選択されていればそれも追加される.
  - 描画のたびにこれをもちいて mask が更新されている.
  - こいつが後々のタスクで使われているもの.

- click_dict はどうせ後で再設計するから容赦なく消す
